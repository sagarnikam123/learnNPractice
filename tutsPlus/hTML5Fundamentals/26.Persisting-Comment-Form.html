<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
	<meta charset="utf-8">
	<title>localStorage-Persisteing comment form</title>
	<script src="javascript/modernizr-latest.js"></script>
	<style>
		label,input[type=submit]{display: block;}
		textarea{width: 300px; height: 150px;
		}
	</style>
</head>

<body>
	<form>
		<label for="comment">Your Comment ?</label>
		<textarea name="comment" id="comment"></textarea>
		<input type="submit">
	</form>
<script src="javascript/jquery-1.11.3.js"></script>

<script>
	// detect localStorage support
	if(Modernizr.localstorage){
		// save comment every five seconds while writing in textarea
		

		// without jQuery
		/*
		var comment = document.getElementById('comment'),
		updateInterval;
		*/

		// with jQuery
		var updateInterval


		// when page subsequently loads, detect storage, and apply value to textarea
		// !!localStorage.comment && (comment.value = localStorage.comment);
		if(localStorage.comment){
			comment.value = localStorage.comment;
		}

		// without jQuery
		
		/*
		comment.addEventListener('focus', function(){
			console.log('Focused');

			updateInterval = setInterval( function(){ 
				//console.log('running')
				localStorage.comment = comment.value;
			}, 5000 )
		}, false);

		comment.addEventListener('blur',function(){
			clearInterval(updateInterval);
		},false);

		*/


		// with jQuery

		$('#comment')
			.on('focus', function(){
				console.log('Focused');
				var $this = $(this);
				// this
				updateInterval = setInterval( function(){ 
					//console.log('running')
					// this = DOMWindow
					localStorage.comment = $this.val();
				}, 5000 )
			})
			.on('blur',function(){
				clearInterval(updateInterval);
			});


	}
	
</script>

</body>


</html>